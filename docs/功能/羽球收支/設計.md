# 文心國際青年商會 羽球收支管理系統

## 專案概述

| 項目 | 說明 |
|------|------|
| 專案名稱 | 羽球收支 SPA |
| 目標用戶 | 文心國際青年商會羽球社 |
| 技術架構 | 純 HTML/CSS/JS + Tailwind CSS + Firebase |

---

## 功能需求

### 核心功能

| 功能 | 說明 | 權限 |
|------|------|------|
| 查看收支 | 以表格顯示所有收支記錄 | 公開 |
| 新增記錄 | 新增收支項目 | 需密碼 |
| 編輯記錄 | 修改既有記錄 | 需密碼 |
| 刪除記錄 | 移除記錄 | 需密碼 |
| 匯入 CSV | 從 CSV 檔案匯入資料 | 需密碼 |
| 匯出 CSV | 下載目前資料為 CSV | 公開 |

### 未來功能（Phase 2）

- 報名系統
- 活動管理

---

## 資料結構

### Firestore Collection: `accounting`

```typescript
interface AccountingRecord {
  id: string;           // Firestore 自動生成
  date: string;         // 時間 (YYYY/MM/DD)
  location: string;     // 地點
  name: string;         // 姓名
  identity: string;     // 身分 (會員/非會員/-)
  item: string;         // 項目
  amountDue: number;    // 應收
  amountPaid: number;   // 已收
  status: string;       // 狀態 (已繳清/已支付/-)
  note: string;         // 備註
  balance: number | null; // 結餘試算 (可選)
  createdAt: Timestamp; // 建立時間
  updatedAt: Timestamp; // 更新時間
}
```

### CSV 欄位對應

| CSV 欄位 | Firestore 欄位 | 類型 |
|----------|----------------|------|
| 時間 | date | string |
| 地點 | location | string |
| 姓名 | name | string |
| 身分 | identity | string |
| 項目 | item | string |
| 應收 | amountDue | number |
| 已收 | amountPaid | number |
| 狀態 | status | string |
| 備註 | note | string |
| 結餘試算 | balance | number |

---

## 技術架構

### 前端

```
index.html
├── Tailwind CSS (CDN)
├── Firebase SDK (CDN)
└── 純 JavaScript (ES6+)
```

### Firebase 設定

```javascript
// firebase-config.js (由用戶填入)
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
```

### Firestore 安全規則

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /accounting/{document=**} {
      // 任何人可讀取
      allow read: if true;
      // 寫入需要驗證（前端密碼驗證後才呼叫）
      allow write: if true;
    }
  }
}
```

> 注意：由於使用前端密碼驗證，Firestore 規則設為開放寫入。
> 如需更安全的方案，可改用 Firebase Auth。

---

## UI 設計

### 頁面結構

```
┌─────────────────────────────────────────┐
│  文心國際青年商會 羽球收支管理           │
│  [匯入 CSV] [匯出 CSV] [🔒 編輯模式]    │
├─────────────────────────────────────────┤
│  統計卡片                                │
│  ┌────────┐ ┌────────┐ ┌────────┐       │
│  │ 總收入  │ │ 總支出  │ │ 目前結餘│      │
│  │ $X,XXX │ │ $X,XXX │ │ $X,XXX │       │
│  └────────┘ └────────┘ └────────┘       │
├─────────────────────────────────────────┤
│  收支明細表格                            │
│  ┌───┬────┬────┬────┬───┬───┬───┬───┐  │
│  │日期│地點│姓名│身分│項目│應收│已收│操作│ │
│  ├───┼────┼────┼────┼───┼───┼───┼───┤  │
│  │...│... │... │... │...│...│...│...│  │
│  └───┴────┴────┴────┴───┴───┴───┴───┘  │
└─────────────────────────────────────────┘
```

### 配色方案 (Tailwind)

| 用途 | 顏色 |
|------|------|
| 主色 | blue-600 |
| 收入 | green-500 |
| 支出 | red-500 |
| 背景 | gray-50 |
| 卡片 | white |

---

## 檔案結構

```
badmintonSPA/
├── index.html          # 主要 SPA
├── firebase-config.js  # Firebase 設定（用戶填入）
├── badminton_accounting.csv  # 原始資料
├── firestore.rules     # Firestore 安全規則
├── firestore.indexes.json
└── docs/
    └── 功能/
        └── 羽球收支/
            └── 設計.md  # 本文件
```

---

## 開發步驟

### Phase 1：基礎功能

1. 建立 index.html 基本結構
2. 整合 Tailwind CSS
3. 實作表格顯示
4. 實作 CSV 匯入/匯出
5. 實作密碼保護編輯模式
6. 實作 CRUD 操作

### Phase 2：Firebase 整合

1. 用戶執行 `firebase init`
2. 填入 firebase-config.js
3. 設定 Firestore 規則
4. 部署至 Firebase Hosting

### Phase 3：未來擴展

1. 報名系統
2. 活動管理
3. 統計圖表

---

## 密碼驗證流程

```
用戶點擊「編輯模式」
        ↓
    彈出密碼輸入框
        ↓
    驗證密碼 (前端比對)
        ↓
    ┌───────────────┐
    │ 正確 → 解鎖編輯 │
    │ 錯誤 → 提示錯誤 │
    └───────────────┘
```

> 密碼儲存在 Firestore `settings/admin` 文件中（雜湊後）

---

## 備註

- 所有日期時間使用 UTC+8 顯示（台灣時間）
- 金額顯示使用千分位格式
- 支援 RWD 響應式設計
